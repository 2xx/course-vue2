"use strict";(self["webpackChunkedu_boss_fed"]=self["webpackChunkedu_boss_fed"]||[]).push([[926],{9705:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"role-alloc-resource"},[e._l(e.roleResourceData,(function(t){return s("el-card",{key:t.id,staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:function(s){return e.handleCheckAllChange(t)}},model:{value:t.selected,callback:function(s){e.$set(t,"selected",s)},expression:"category.selected"}},[e._v(e._s(t.name))])],1),s("el-checkbox-group",{on:{change:function(s){return e.handleCheckedResourceChange(t)}},model:{value:t.checkedResourceIds,callback:function(s){e.$set(t,"checkedResourceIds",s)},expression:"category.checkedResourceIds"}},[s("el-row",e._l(t.resourceList,(function(t){return s("el-col",{key:t.id,attrs:{span:8}},[s("el-checkbox",{staticStyle:{padding:"7px 0px"},attrs:{label:t.id}},[e._v(e._s(t.name))])],1)})),1)],1)],1)})),s("div",{staticClass:"footer-btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")]),s("el-button",{on:{click:e.onClear}},[e._v("清空")])],1)],2)},o=[],c=s(9591),n={name:"RoleAllocResource",props:{roleId:{type:[String,Number],required:!0}},data(){return{roleResourceData:[]}},created(){this.loadRoleResources()},methods:{loadRoleResources(){(0,c._9)(this.roleId).then((e=>{"000000"===e.data.code?this.roleResourceData=e.data.data.map((e=>{let{id:t,name:s,resourceList:r,selected:o,sort:c}=e;const n=[],l=[];r=r?.map((e=>{const{id:t,name:s,selected:r,url:o,description:c}=e;return r&&n.push(t),l.push(t),{id:t,name:s,selected:r,url:o,description:c}}));const a=n.length>0&&n.length<l.length;return o=n.length===l.length,{id:t,name:s,resourceList:r,selected:o,sort:c,checkedResourceIds:n,allResourceIds:l,isIndeterminate:a}})).sort(((e,t)=>e.id-t.id)):this.$message.error("获取角色拥有的资源信息失败...")}))},handleCheckAllChange(e){e.checkedResourceIds=e.selected?e.allResourceIds:[],e.isIndeterminate=!1},handleCheckedResourceChange(e){const t=e.checkedResourceIds.length,s=e.allResourceIds.length;e.selected=t===s,e.isIndeterminate=t>0&&t<s},onClear(){this.roleResourceData.forEach((e=>{e.checkedResourceIds=[],e.selected=!1}))},onSave(){const{roleId:e,roleResourceData:t}=this,s=t.reduce(((e,t)=>e.concat(t.checkedResourceIds)),[]);(0,c.GZ)({roleId:e,resourceIdList:s}).then((e=>{"000000"===e.data.code?(this.$message.success("给角色分配资源成功!"),this.$router.push({name:"roles"})):this.$message.error("给角色分配资源失败...")}))}}},l=n,a=s(1001),d=(0,a.Z)(l,r,o,!1,null,"134d6056",null),u=d.exports},9591:function(e,t,s){s.d(t,{GZ:function(){return i},Rd:function(){return l},WR:function(){return d},_9:function(){return u},_L:function(){return a},cY:function(){return c},ix:function(){return o},zZ:function(){return n}});var r=s(5972);const o=e=>(0,r.Z)({method:"POST",url:"/boss/role/getRolePages",data:e}),c=e=>(0,r.Z)({method:"GET",url:`/boss/role/${e}`}),n=e=>(0,r.Z)({method:"POST",url:"/boss/role/saveOrUpdate",data:e}),l=e=>(0,r.Z)({method:"DELETE",url:`/boss/role/${e}`}),a=e=>(0,r.Z)({method:"GET",url:"/boss/menu/getRoleMenus",params:{roleId:e}}),d=e=>(0,r.Z)({method:"POST",url:"/boss/menu/allocateRoleMenus",data:e}),u=e=>(0,r.Z)({method:"GET",url:"/boss/resource/getRoleResources",params:{roleId:e}}),i=(e={})=>(0,r.Z)({method:"POST",url:"/boss/resource/allocateRoleResources",data:e})}}]);